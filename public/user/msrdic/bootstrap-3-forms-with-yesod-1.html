<!DOCTYPE html>
<html><head><title>Bootstrap 3 forms with Yesod - School of Haskell | School of Haskell</title><meta http-equiv="x-ua-compatible" content="IE=9"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="google-site-verification" content="Rfxk2TdeMMXEXHgJ2_OO8Rt3hPbQSDao0OXQV_n6z_s" /><link href="//fonts.googleapis.com/css?family=Merriweather" rel="stylesheet" type="text/css"><link href="https://www.schoolofhaskell.com/recent-content/feed" type="application/rss+xml" rel="alternate" title="Recently published content">
<link rel="stylesheet" href="https://www.schoolofhaskell.com/static/combined/UlwEHVcM.css"><style>.social{margin-right:1em}h1{font-family:Merriweather !important}article{font-family:Merriweather !important}article li{font-family:Merriweather !important;line-height:1.6em}h1,h2,h3,h4,h4,h5{font-family:Merriweather !important}.editor p{font-family:Frutiger, "Frutiger Linotype", Univers, Calibri, "Gill Sans", "Gill Sans MT", "Myriad Pro", Myriad, "DejaVu Sans Condensed", "Liberation Sans", "Nimbus Sans L", Tahoma, Geneva, "Helvetica Neue", Helvetica, Arial, sans-serif}.article-footer{border-top:1px solid #ddd;padding-top:1em;margin-top:1em}body{font-size:16px !important}.navbar .navbar-inner{background:#3c3f41}.navbar .brand{font-size:14px}.navbar .brand img{width:6em}.navbar .icon-wrench{margin:0 -0.5em 0 -0.5em;padding:0 1em 0 1em;height:20px}.navbar-inverse .nav .active a{background:#333638}.navbar-inverse .nav > li > a{color:#a7a7a7
}.navbar-inverse .btn-navbar{background:#333638}.navbar-inverse .nav > li a:hover,.navbar-inverse .btn{background:#333537 !important}@media (max-width: 979px) {.icon-wrench{padding-left:1em !important}}.breadcrumb{border-top-left-radius:0;border-top-right-radius:0}h1{margin-top:20px}.breadcrumb-container + .main-content h1{margin-top:0}.footer{padding:30px 0;margin-top:70px;border-top:1px solid #e5e5e5;background-color:#f5f5f5}.footer ul.footer-menu{list-style-type:none}.footer ul.footer-menu li{display:inline-block}.footer ul.footer-menu li + li{margin-left:0.5em}.footer ul.footer-menu li + li:before{margin-right:0.5em;content:"Â·";color:#999}.footer ul.menu li{display:inline-block}.footer ul.menu li + li{margin-left:0.5em}.footer .copyright{margin-left:25px}.main-content{min-height:100%}.gravatar{width:80px;height:80px;border-radius:2px;background:#eee}.empty-gravatar{width:0}.container{font-family:"Segoe UI", Candara, "Bitstream Vera Sans", "DejaVu Sans", "Bitstream Vera Sans", "Trebuchet MS", Verdana, "Verdana Ref", sans-serif}.container h1,.container h2,.container h4,.container h4,.container h5{font-family:"Segoe UI", Candara, "Bitstream Vera Sans", "DejaVu Sans", "Bitstream Vera Sans", "Trebuchet MS", Verdana, "Verdana Ref", sans-serif}article{font-family:Merriweather !important}article h1{font-family:Merriweather !important}article li{font-family:Merriweather !important;line-height:1.6em}article li + li{margin-top:0.5em}article div.code{background:#f9f9f9;border:1px solid #d1d1d1;position:relative;border-radius:0.2em;margin:0.25em 0 0.75em 0;min-height:2.5em}article code{color:#005580;font-size:14px;white-space:pre}article a.hoogle > code{color:#0088cc;font-size:14px;white-space:pre;border:0}article .expand-code{display:none}article pre{overflow:auto;word-wrap:normal}article code.active{display:block;max-height:430px}article h1{font-size:31.5px}article h3{font-size:17.5px}article h4{font-size:14px}article h5,article h6{font-size:11.9px}article p{line-height:1.7em}article h1 code,article h2 code,article h3 code,article h4 code,article h5 code,article h6 code{font-size:inherit !important}article h1 a,article h2 a,article h3 a,article h4 a,article h5 a,article h6 a{color:#444}article h1 a:before,article h2 a:before,article h3 a:before,article h4 a:before,article h5 a:before,article h6 a:before{margin-left:-1.5em;padding-right:0.5em;font-family:fontawesome;content:"\f0c1";font-size:20px;color:#fff}article h1 a:hover,article h2 a:hover,article h3 a:hover,article h4 a:hover,article h5 a:hover,article h6 a:hover{text-decoration:none;color:#0088cc}article h1 a:hover:before,article h2 a:hover:before,article h3 a:hover:before,article h4 a:hover:before,article h5 a:hover:before,article h6 a:hover:before{color:#888}article h2{font-size:24.5px}article .popover{font-family:actor}article .popover h3.popover-title{font-family:actor !important;font-size:1em}article .popover .popover-content{width:15em;font-size:1em}article .controlsRun{display:block;padding:0.5em;text-align:right;background:#f2f2f2}article .controlsRun a.clone{margin-right:1em;font-family:actor;text-decoration:none}article .controlsRun a.clone span{padding-left:0.5em}article .controlsRun a.run,article .controlsRun a.reset,article .controlsRun a.show-code{font-size:16px}article .controlsRun a.run span,article .controlsRun a.reset span,article .controlsRun a.show-code span{display:none}article .controlsRun a.reset{margin-left:0.5em;color:#a2becc}article .controlsRun a.reset{display:none}article .controlsRun a.show-code{margin-right:0.75em}article .controlsRun a.run:hover,article .controlsRun a.show-code:hover{text-decoration:none}article .controlsRun a.show-code.active{color:#DC0D0D}article .controlsRun a[disabled]{color:#a2becc;cursor:default}article .collapse-area .collapse-header{background:#0088cc;color:#fff;padding:0.3em;cursor:pointer}article .collapse-area .hidden-toggle:before{content:"\f0d7";font-family:fontawesome;margin-right:0.5em;margin-left:0.25em}article .collapse-area .collapsed-files{overflow:auto;height:auto}article .collapse-area.collapse-disabled{display:none}article .collapse-area.collapse-area-off .collapsed-files{height:0px;overflow:hidden}article .collapse-area.collapse-area-off .hidden-toggle:before{content:"\f0da"}article .snippet-stdio .stdout{margin:0.5em;padding-right:2em;position:relative;word-wrap:break-word}article .snippet-stdio .stdin{-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;-webkit-transition:none;-moz-transition:none;-o-transition:none;transition:none;padding:0;margin:0}article .hoogle-results{margin:0.25em}article .hoogle-results .hoogle-inner{background:#fff;padding:0.5em;border-radius:3px;border:1px solid #ddd}article .hoogle-results .hoogle-inner .close-link{position:relative;float:right;margin-top:-0.5em;margin-right:-0.5em}article .snippet-output-errors{margin:1em 0.5em 0.5em 0.5em;position:relative}article .snippet-output-errors ul{list-style-type:none;margin:0;position:relative}article .snippet-output-errors pre{border:0;border-radius:0;padding:0.25em;margin:0;background:inherit;color:inherit}article .snippet-output-errors .close-link{color:inherit;background:inherit}article .snippet-editors{z-index:0;padding:0.25em}article .close-link{padding:0.5em;background:#eaeaea;border-bottom-left-radius:0.2em;border-top-right-radius:0.2em;position:absolute;top:0;right:0}article .close-link:hover{text-decoration:none}article .snippet-title{padding:0.5em 0 0 0.5em}article .snippet-title .snippet-icon{font-family:FontAwesome;display:inline-block;margin-right:0.5em}article .fullModuleCode + div .snippet-title{margin-top:0.5em;border-top:1px solid #ccc;padding-top:0.5em}article .CodeMirror{height:auto;min-height:1em;line-height:1.5em;background:transparent;font-size:14px !important}article .CodeMirror .highlighted{background:rgba(250, 210, 0, 0.45) !important}article .CodeMirror-widget{margin-left:2em;line-height:1.8}article .CodeMirror.collapsed{height:10em !important}article .editor .expander{text-align:center;display:block;padding:0.5em;text-decoration:none;border-bottom-left-radius:2px;border-bottom-right-radius:2px}article .editor .expander .ellipsis{background:white;border:1px solid #ccc;padding:0 0.5em;height:1em;line-height:0.5em;display:inline-block;color:#555;cursor:pointer}article .editor .expander .ellipsis:hover{background:#ddd;color:#333}article .web-runner{margin:0.5em;padding:0.5em;border:1px solid #ccc;border-radius:3px;background:#f5f5f5}article .web-runner iframe{border:0;margin-top:0.5em;margin-bottom:0;background:white}article .web-runner .controls i{cursor:pointer;color:#0088cc}article .web-runner .controls i:hover{color:#222}article .web-runner .controls i + i{margin-left:0.5em}article .web-runner .controls .icon-remove{float:right}article .hidden{display:block;visibility:visible}article .controlsShowHide{margin-bottom:0.5em}.tutorial-body{float:left !important}.tutorial-nav{float:right !important}@media (max-width: 979px) {.related-content{float:right}.author-name{display:block;margin-left:20px !important;padding-left:5px;margin-top:5px}article h1 a:hover:before,article h2 a:hover:before,article h3 a:hover:before,article h4 a:hover:before,article h5 a:hover:before,article h6 a:hover:before{color:#fff}.tutorial-nav{float:none !important;width:auto !important}.tutorial-body{float:none !important;width:auto !important}}@media (min-width: 980px) and (max-width: 1199px) {.navbar-search{display:none}.tutorial-nav{width:200px}.tutorial-body{width:720px}}#accountPage h1{margin:20px 0 0 0}#accountPage h2{font-size:20px}.group-contents .span8{float:left}.group-contents .span4{float:right}.container > .alert-block{margin-top:1em}.alert{color:#aa874a
}.social{margin-bottom:.8em;display:block}.social a{text-decoration:none}.social i{font-size:1.1em;color:#fff;padding:0.25em;border-radius:0.25em;width:1em;display:inline-block;text-align:center}.social i.icon-twitter{background:#0088cc}.social i.icon-facebook{background:#3b5998
  }.social i.icon-google-plus{background:#dd4b39
  }.well pre{background:#fcfcfc}.well h2{margin-top:0}code{color:#005580;font-size:14px;white-space:pre}</style><!--[if lt IE 8]><link rel="stylesheet" href="https://www.schoolofhaskell.com/static/design/css/ie7.css?etag=TSMl9x1V"><![endif]--><!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]--></head><body class="not-logged-in" itemscope itemtype="http://schema.org/Product"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-H62P" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-H62P');</script><div class="navbar navbar-inverse navbar-static-top"><div class="navbar-inner"><div class="container"><a class="btn btn-navbar" type="button" data-toggle="collapse" data-target=".nav-collapse"><span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</a>
<a class="brand" href="/"><img src="/static/img/haskell-logo-wide.png" title="School of Haskell">
</a>
<div class="nav-collapse collapse"><ul class="nav"><li><a href="https://www.schoolofhaskell.com/">School</a>
</li>
<li><a href="https://www.schoolofhaskell.com/user">Users</a>
</li>
</ul>
<form class="navbar-search pull-left" action="https://www.schoolofhaskell.com/search"><input class="search-query" type="text" placeholder="Search" name="search">
</form>
</div>
</div>
</div>
</div>
<div class="container breadcrumb-container"><div class="row"><div class="span12"><ul class="breadcrumb"><li><a href="https://www.schoolofhaskell.com/user/msrdic">Mladen Srdic</a>
<span class="divider">/</span>
</li>
<li><a href="https://www.schoolofhaskell.com/user/msrdic/bootstrap-3-forms-with-yesod-1">Bootstrap 3 forms with Yesod</a>
</li>
</ul>
</div>
</div>
</div>
<div class="container main-content"><div class="row"><div class="span12"><h1 itemprop="name">Bootstrap 3 forms with Yesod</h1>
</div>
</div>
<div class="row"><div class="span7 meta"><p><span class="date"> 6 Apr 2017</span>
<span class="author"><a href="https://www.schoolofhaskell.com/user/msrdic">Mladen Srdic</a>
</span>
<span class="view-edit-link pull-right"><a class="view-source-link" href="https://www.schoolofhaskell.com/tutorial-raw/2625/590ac781209e7d4f25882b0c7e687a6271976566">View Markdown source</a>
</span>
</p>
<p class="tags"></p>
</div>
</div>
<div class="row"><div class="span7 meta"><span class="sociallinksunicode social">
<a href="https://twitter.com/home?status=$url$" target="_blank"><i class="icon-twitter"></i></a>&nbsp;
<a href="http://www.facebook.com/sharer/sharer.php?u=$url$" target="_blank"><i class="icon-facebook"></i></a>&nbsp;
<a href="https://plus.google.com/share?url=$url$" target="_blank"><i class="icon-google-plus"></i></a></span>
</div>
</div>
<p class="alert">As of March 2020, School of Haskell has been switched to read-only mode.</p>
<div class="row" itemprop="desc"><div class="span4 tutorial-nav"><div class="related-content"><ul class="nav nav-tabs nav-stacked"><li><script>reddit_target='fpcomplete'</script>
<script src="https://redditstatic.s3.amazonaws.com/button/button1.js"></script>
</li>
<li><a href="https://www.schoolofhaskell.com/user/msrdic">See all content by Mladen Srdic</a>
</li>
</ul>

</div>
<div class="aside"><h3>Sections</h3>
<ul><li><a href="#bootstrap-3-form-kinds">Bootstrap 3 form kinds</a></li><li><a href="#forms-comparison">Forms comparison</a></li><li><a href="#first-steps">First steps</a></li><li><a href="#constructing-forms-in-yesod">Constructing forms in Yesod</a></li><li><a href="#getting-closer">Getting closer</a></li><li><a href="#constructing-bootstrap-3-forms">Constructing Bootstrap 3 forms</a></li><li><a href="#the-full-example">The full example</a></li><li><a href="#things-that-are-missing---">Things that are missing...</a></li></ul></div>
</div>
<div class="span8 tutorial-body" data-environment="ghc-7.8-stable-14.09">
<article><hr /><p><i>Edit: this utility code has been modified by <a href="https://github.com/meteficha">Felipe Lessa</a> and merged into <a href="https://github.com/yesodweb/yesod/pull/687">Yesod</a>.</i></p><hr /><p>While working with forms in Yesod, I noticed that the <code>renderBootstrap</code> functionality doesn't work with Bootstrap 3. There were some breaking changes introduced in version 3, so it got me thinking of implementing some basic support for Bootstrap 3 forms.</p><h2 id="bootstrap-3-form-kinds"><a href="#bootstrap-3-form-kinds">Bootstrap 3 form kinds</a></h2><p>As can be seen in <a href="http://getbootstrap.com/css/#forms">Bootstrap forms documentation</a>, there are basically three kinds of forms in Bootstrap.</p><p>The first kind of form is the simplest of all: it arranges its elements one per row. Here's some HTML code for a basic form:</p><pre><code class="html">&lt;form&gt;
  &lt;div class=&quot;form-group&quot;&gt;
    &lt;label for=&quot;name&quot;&gt;Name&lt;/label&gt;
    &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;name&quot; placeholder=&quot;Name&quot;&gt;
  &lt;/div&gt;
  &lt;div class=&quot;form-group&quot;&gt;
    &lt;label for=&quot;surname&quot;&gt;Surname&lt;/label&gt;
    &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;surname&quot; placeholder=&quot;Surname&quot;&gt;
  &lt;/div&gt;
  &lt;button type=&quot;submit&quot; class=&quot;btn btn-default&quot;&gt;Submit&lt;/button&gt;
&lt;/form&gt;</code></pre><p>Labels and input fields are grouped in containers that have a class attribute <code>form-group</code> and input fields additionally have a class attribute <code>form-control</code>.</p><p>The second kind of form is an inline form. This form doesn't have any labels, but they are just rendered hidden because screen readers can still &quot;see&quot; them. The example source code for this form looks like this:</p><pre><code class="html">&lt;form class=&quot;form-inline&quot;&gt;
  &lt;div class=&quot;form-group&quot;&gt;
    &lt;label class=&quot;sr-only&quot; for=&quot;name&quot;&gt;Name&lt;/label&gt;
    &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;name&quot; placeholder=&quot;Name&quot;&gt;
  &lt;/div&gt;
  &lt;div class=&quot;form-group&quot;&gt;
    &lt;label class=&quot;sr-only&quot; for=&quot;surname&quot;&gt;Surname&lt;/label&gt;
    &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;surname&quot; placeholder=&quot;Surname&quot;&gt;
  &lt;/div&gt;
  &lt;button type=&quot;submit&quot; class=&quot;btn btn-default&quot;&gt;Submit&lt;/button&gt;
&lt;/form&gt;</code></pre><p>The third kind of form is a horizontal form. This form has its elements arranged in a grid, where each group of controls (label, field and tooltips container) has its own row. The example form would look like this:</p><pre><code class="html">&lt;form class=&quot;form-horizontal&quot;&gt;
  &lt;div class=&quot;form-group&quot;&gt;
    &lt;label for=&quot;name&quot; class=&quot;col-sm-2 control-label&quot;&gt;Name&lt;/label&gt;
    &lt;div class=&quot;col-sm-4&quot;&gt;
      &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;name&quot; placeholder=&quot;Name&quot;&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div class=&quot;form-group&quot;&gt;
    &lt;label for=&quot;surname&quot; class=&quot;col-sm-2 control-label&quot;&gt;Surname&lt;/label&gt;
    &lt;div class=&quot;col-sm-4&quot;&gt;
      &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;name&quot; placeholder=&quot;Surname&quot;&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div class=&quot;form-group&quot;&gt;
    &lt;div class=&quot;col-sm-offset-2 col-sm-4&quot;&gt;
      &lt;button type=&quot;submit&quot; class=&quot;btn btn-default&quot;&gt;Submit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/form&gt;</code></pre><h2 id="forms-comparison"><a href="#forms-comparison">Forms comparison</a></h2><p>From the examples above we can see that these forms are pretty similar, with minor differences that will affect the implementation. The type of form is determined via <code>class</code> parameter, or, in the case of a basic form, no <code>class</code> parameter. In all of the three cases form controls are contained inside the <code>div</code> container with a <code>class</code> attribute of <code>form-group</code>. In case of inline forms, labels have a <code>class</code> attribute of <code>sr-only</code>. Input fields of horizontal forms have its own <code>div</code> container, and additionally, labels and enclosing field containers have <code>class</code> attributes for positioning and sizing. With these in mind, we can slowly begin implementing some basic support for these kinds of forms.</p><h2 id="first-steps"><a href="#first-steps">First steps</a></h2><p>As I already said above, there's a Bootstrap support in Yesod, but it's outdated. Here's the <code>renderBootstrap</code> function, taken from the <code>Yesod.Form.Functions</code> module, with the rendering code marked:</p><pre><code class="haskell">renderBootstrap :: Monad m =&gt; FormRender m a
renderBootstrap aform fragment = do
    (res, views') &lt;- aFormToForm aform
    let views = views' []
        has (Just _) = True
        has Nothing  = False
    let widget = [whamlet|
                $newline never
                \#{fragment}
          {-hi-}$forall view &lt;- views {-/hi-}
              {-hi-}&lt;div .control-group .clearfix :fvRequired view:.required :not $ fvRequired view:.optional :has $ fvErrors view:.error&gt;{-/hi-}
                  {-hi-}&lt;label .control-label for=#{fvId view}&gt;#{fvLabel view}{-/hi-}
                  {-hi-}&lt;div .controls .input&gt;{-/hi-}
                      {-hi-}^{fvInput view}{-/hi-}
                      {-hi-}$maybe tt &lt;- fvTooltip view{-/hi-}
                          {-hi-}&lt;span .help-block&gt;#{tt}{-/hi-}
                      {-hi-}$maybe err &lt;- fvErrors view{-/hi-}
                          {-hi-}&lt;span .help-block&gt;#{err}{-/hi-}
                |]
    return (res, widget)</code></pre><p>The rendering code loops through the list of <code>views</code> and renders every form element Bootstrap-friendly, so this is the first place for introducing Bootstrap 3 changes. The first thing to change is the <code>class</code> attribute of an eclosing container from <code>.control-group</code> to <code>.form-group</code>. To make other changes in rendering function, we first need to introduce some additional data types and utility functions.</p><p>The first data type that's useful is a <code>BootstrapForm</code> data type:</p><pre><code class="haskell">data BootstrapForm = BootstrapBasicForm | BootstrapInlineForm
    | BootstrapHorizontalForm { containerOffset :: GridOptions, container :: GridOptions, label :: GridOptions }</code></pre><p>Since a horizontal form has additional parameters for positioning and sizing form elements, we need to introduce a data type to represent these parameters. <code>GridOptions</code> is a data type encoding <a href="http://getbootstrap.com/css/#grid-options">standard grid sizes</a> in Bootstrap 3 and is defined as following:</p><pre><code class="haskell">data GridOptions = ColXs Int | ColSm Int | ColMd Int | ColLg Int

instance Show GridOptions where
    show (ColXs 0) = &quot;&quot;
    show (ColXs columns) = &quot;col-xs-&quot; ++ show columns

    show (ColSm 0) = &quot;&quot;
    show (ColSm columns) = &quot;col-sm-&quot; ++ show columns

    show (ColMd 0) = &quot;&quot;
    show (ColMd columns) = &quot;col-md-&quot; ++ show columns

    show (ColLg 0) = &quot;&quot;
    show (ColLg columns) = &quot;col-lg-&quot; ++ show columns

instance ToMarkup GridOptions where
    toMarkup = toMarkup . show</code></pre><p>The <code>Show</code> and <code>ToMarkup</code> instances are also useful, since we intend on rendering these options as class attributes.</p><p>We use the <code>GridOptions</code> and <code>BootstrapForm</code> data types and introduce a <code>BootstrapFormConfig</code> in the following way:</p><pre><code class="haskell">data BootstrapFormConfig = BootstrapFormConfig { form :: BootstrapForm, submit :: String }</code></pre><p>The <code>submit</code> field will be used later in rendering the submit button.</p><h2 id="constructing-forms-in-yesod"><a href="#constructing-forms-in-yesod">Constructing forms in Yesod</a></h2><p>It is very simple to construct a form with Yesod and the code could look something like this:</p><pre><code class="haskell">personForm :: Html -&gt; MForm Handler (FormResult Person, Widget)
personForm = renderBootstrap $ Person
    &lt;$&gt; areq textField &quot;Name&quot; Nothing
    &lt;*&gt; areq textField &quot;Surname&quot; Nothing</code></pre><p>This is the basic example with the <code>Person</code> entity introduced in the form examples above. The string parameters (<code>&quot;Name&quot;</code> and <code>&quot;Surname&quot;</code>) are automatically converted to <code>FieldSettings</code> data types since there's an instance <code>IsString</code> defined for <code>FieldSettings</code> data type. <code>FieldSettings</code> data type (from <code>Yesod.Form.Types</code>) looks like this:</p><pre><code class="haskell">data FieldSettings master = FieldSettings
    { fsLabel :: SomeMessage master
    , fsTooltip :: Maybe (SomeMessage master)
    , fsId :: Maybe Text
    , fsName :: Maybe Text
    , fsAttrs :: [(Text, Text)]
    }</code></pre><p>Additionaly, the <code>textField</code> function (from <code>Yesod.Form.Fields</code>) used in form construction looks like this:</p><pre><code class="haskell">textField :: Monad m =&gt; RenderMessage (HandlerSite m) FormMessage =&gt; Field m Text
textField = Field
    { fieldParse = parseHelper $ Right
    , fieldView = \theId name attrs val isReq -&gt;
        [whamlet|
$newline never
{-hi-}&lt;input id=&quot;#{theId}&quot; name=&quot;#{name}&quot; *{attrs} type=&quot;text&quot; :isReq:required value=&quot;#{either id id val}&quot;&gt;{-/hi-}
|]
    , fieldEnctype = UrlEncoded
    }</code></pre><p>The important part is marked: all the parameters are rendered in a <code>hamlet</code> block, and the part that's most interesting to us is the <code>attrs</code> parameter, since it contains the <code>class</code> attribute and all the other attributes that are not one of the defined in the block above (<code>id</code>, <code>name</code> etc.). We need to somehow alter the <code>attrs</code> parameter to include the <code>placeholder</code> attribute and to introduce additonal <code>class</code> attributes.</p><h2 id="getting-closer"><a href="#getting-closer">Getting closer</a></h2><p>We want to continue using the <code>areq</code> (and other applicative variations like <code>aopt</code>, <code>mreq</code> and <code>mopt</code>), but we also want to introduce additional parameters to support Bootstrap 3. The type of <code>areq</code> looks like this:</p><pre><code class="haskell">Prelude Yesod&gt; :t areq
areq
  :: (MonadHandler m, RenderMessage (HandlerSite m) FormMessage) =&gt;
     Field m a -&gt; FieldSettings (HandlerSite m) -&gt; Maybe a -&gt; AForm m a</code></pre><p>The last parameter to <code>areq</code> is the optional default value.</p><p>Let's introduce an additional parameter to the <code>renderBootstrap</code> function, namely the <code>BootstrapFormConfig</code>. The function (with the changes mentioned in <a href="#first-steps">First steps</a>) now looks like this:</p><pre><code class="haskell">renderBootstrap :: Monad m =&gt; BootstrapFormConfig -&gt; FormRender m a
renderBootstrap {-hi-}formConfig{-/hi-} aform fragment = do
    (res, views') &lt;- aFormToForm aform
    let views = views' []
        has (Just _) = True
        has Nothing  = False
    let widget = [whamlet|
                $newline never
                \#{fragment}
                $forall view &lt;- views
                    &lt;div {-hi-}.form-group{-/hi-} .clearfix :fvRequired view:.required :not $ fvRequired view:.optional :has $ fvErrors view:.error&gt;
                        &lt;label .control-label for=#{fvId view}&gt;#{fvLabel view}
                        &lt;div .controls .input&gt;
                            ^{fvInput view}
                            $maybe tt &lt;- fvTooltip view
                                &lt;span .help-block&gt;#{tt}
                            $maybe err &lt;- fvErrors view
                                &lt;span .help-block&gt;#{err}
                |]
    return (res, widget)</code></pre><p>We're now going to use the newly introduced <code>formConfig</code> parameter to render all three kinds of forms. We want to check which kind of form we're working with and render it in a way described in <a href="#bootstrap-3-form-kinds">Bootstrap 3 form kinds</a> and <a href="#forms-comparison">Forms comparison</a>. Then we want to introduce the submit button as well, since the positioning of submit button depends on the form parameters.</p><pre><code class="haskell">renderBootstrap formConfig aform fragment = do
    (res, views') &lt;- aFormToForm aform
    let views = views' []
        has (Just _) = True
        has Nothing  = False
        widget = [whamlet|
                        \#{fragment}
                        $forall view &lt;- views
                          &lt;div .form-group :fvRequired view:.required :not $ fvRequired view:.optional :has $ fvErrors view:.error&gt;
                            {-hi-}$case (form formConfig){-/hi-}
                              {-hi-}$of BootstrapBasicForm{-/hi-}
                                {-hi-}&lt;label for=#{fvId view}&gt;#{fvLabel view}{-/hi-}
                                {-hi-}^{fvInput view}{-/hi-}
                                {-hi-}^{helpWidget view}{-/hi-}
                              {-hi-}$of BootstrapInlineForm{-/hi-}
                                {-hi-}&lt;label .sr-only for=#{fvId view}&gt;#{fvLabel view}{-/hi-}
                                {-hi-}^{fvInput view}{-/hi-}
                                {-hi-}^{helpWidget view}{-/hi-}
                              {-hi-}$of BootstrapHorizontalForm containerOffset containerClass labelClass{-/hi-}
                                {-hi-}&lt;label .control-label .#{labelClass} for=#{fvId view}&gt;#{fvLabel view}{-/hi-}
                                {-hi-}&lt;div .#{containerClass}&gt;{-/hi-}
                                  {-hi-}^{fvInput view}{-/hi-}
                                {-hi-}^{helpWidget view}{-/hi-}

                        {-hi-}^{submitWidget $ formConfig}{-/hi-}
                |]
    return (res, widget)</code></pre><p>We've also extracted the two functions, just for readability sake:</p><pre><code class="haskell">submitWidget (BootstrapFormConfig (BootstrapHorizontalForm containerOffset containerClass labelClass) submit) = [whamlet|
&lt;div .form-group&gt;
    &lt;div .#{toOffset containerOffset} .#{containerClass}&gt;
      &lt;button type=submit .btn .btn-default&gt;#{submit}
|]
submitWidget (BootstrapFormConfig _ submit) = [whamlet|&lt;button type=submit .btn .btn-default&gt;#{submit}|]

helpWidget view = [whamlet|
    $maybe tt &lt;- fvTooltip view
      &lt;span .help-block&gt;#{tt}
    $maybe err &lt;- fvErrors view
      &lt;span .help-block&gt;#{err}
|]

toOffset :: GridOptions -&gt; String
toOffset (ColXs 0) = &quot;&quot;
toOffset (ColSm 0) = &quot;&quot;
toOffset (ColMd 0) = &quot;&quot;
toOffset (ColLg 0) = &quot;&quot;
toOffset (ColXs columns) = &quot;col-xs-offset-&quot; ++ show columns
toOffset (ColSm columns) = &quot;col-sm-offset-&quot; ++ show columns
toOffset (ColMd columns) = &quot;col-md-offset-&quot; ++ show columns
toOffset (ColLg columns) = &quot;col-lg-offset-&quot; ++ show columns</code></pre><p>And lastly, we introduce the function for building <code>FieldSettings</code> values. We also add an additional parameter for the placeholder attribute. We then introduce the placeholder parameter as one of the input attributes with the <code>attrsFromFormConfig</code> function.</p><pre><code class="haskell">bootstrapFieldSettings :: BootstrapFormConfig -&gt; SomeMessage site -&gt; Maybe (SomeMessage site)
    -&gt; Maybe Text -&gt; Maybe Text -&gt; Maybe Text -&gt; FieldSettings site
bootstrapFieldSettings formConfig msg tooltip placeholder id name =
    FieldSettings msg tooltip id name (attrsFromFormConfig formConfig placeholder)

attrsFromFormConfig :: BootstrapFormConfig -&gt; Maybe Text -&gt; [(Text, Text)]
attrsFromFormConfig _ Nothing = [(&quot;class&quot;, &quot;form-control&quot;)]
attrsFromFormConfig _ (Just placeholder) = [(&quot;class&quot;, &quot;form-control&quot;), (&quot;placeholder&quot;, placeholder)]</code></pre><h2 id="constructing-bootstrap-3-forms"><a href="#constructing-bootstrap-3-forms">Constructing Bootstrap 3 forms</a></h2><p>With all these building blocks in place, we can now construct a Bootstrap 3 form. This is the noisy way to construct a basic form since we need to supply all the parameters for <code>FieldSettings</code> parameter:</p><pre><code class="haskell">personHForm = renderBootstrap hConfig $ Person
    &lt;$&gt; areq textField (bootstrapFieldSettings config &quot;Name&quot; Nothing (Just &quot;Person name&quot;) Nothing Nothing) Nothing
    &lt;*&gt; areq textField (bootstrapFieldSettings config &quot;Surname&quot; Nothing (Just &quot;Person surname&quot;) Nothing Nothing) Nothing</code></pre><p>To make things a little bit easier, as we only care about labels and placeholders, we can extract the <code>bootstrapFieldHelper</code> function:</p><pre><code class="haskell">bootstrapFieldHelper config label placeholder =
    bootstrapFieldSettings config label Nothing placeholder Nothing Nothing</code></pre><p>The code for constructing the basic form now looks like this:</p><pre><code class="haskell">personForm :: Html -&gt; MForm Handler (FormResult Person, Widget)
personForm = renderBootstrap bConfig $ Person
    &lt;$&gt; areq textField (bootstrapFieldHelper bConfig &quot;Name&quot; (Just &quot;Person name&quot;)) Nothing
    &lt;*&gt; areq textField (bootstrapFieldHelper bConfig &quot;Surname&quot; (Just &quot;Person surname&quot;)) Nothing</code></pre><h2 id="the-full-example"><a href="#the-full-example">The full example</a></h2><p>The full example, showing both inline and horizontal forms, is below. It also shows other field types that I checked by now, in a larger example. The embedded browser doesn't render the inline form correctly, so opening it in a new tab should show everything as expected.</p><pre><code class="haskell active web">
{-# START_FILE Foundation.hs #-}

{-# LANGUAGE TemplateHaskell #-}
{-# LANGUAGE MultiParamTypeClasses #-}
{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE TypeFamilies #-}

module Foundation where

import           Yesod                   hiding (renderBootstrap)
import           Yesod.Form.Jquery

import           Data.Text               (Text)
import           Data.Time               (Day, TimeOfDay (..))

import           Control.Applicative     ((&lt;$&gt;), (&lt;*&gt;))

import           Form.Bootstrap3

data FormApp = FormApp

instance Yesod FormApp

instance YesodJquery FormApp where
    urlJqueryJs _ = Right &quot;//ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js&quot;

instance RenderMessage FormApp FormMessage where
    renderMessage _ _ = defaultFormMessage

mkYesodData &quot;FormApp&quot; $(parseRoutesFile &quot;config/routes&quot;)

data Person = Person { name :: Text, surname :: Text }
    deriving Show

data LargeData = LargeData {
    textField1       :: Text,
    intField1        :: Int,
    doubleField1     :: Double,
    textAreaField1   :: Textarea,
    hiddenField1     :: Text,
    passwordField1   :: Text,
    emailField1      :: Text,
    htmlField1       :: Html,
    dayField1        :: Day,
    timeField1       :: TimeOfDay,
    searchField1     :: Text,
    urlField1        :: Text,
    selectField1     :: Bool,
    checkboxField1   :: Bool
    }

hConfig = BootstrapFormConfig { form = BootstrapHorizontalForm (ColXs 2) (ColXs 4) (ColXs 2), submit = &quot;Create user&quot; }
iConfig = BootstrapFormConfig { form = BootstrapInlineForm, submit = &quot;Create user&quot;}
bConfig = BootstrapFormConfig { form = BootstrapBasicForm, submit = &quot;Create user&quot; }
largeFormConfig = BootstrapFormConfig { form = BootstrapHorizontalForm (ColXs 2) (ColXs 4) (ColXs 2), submit = &quot;Submit large data&quot; }

bootstrapFieldHelper config label placeholder = bootstrapFieldSettings config label Nothing placeholder Nothing Nothing

personHForm :: Html -&gt; MForm Handler (FormResult Person, Widget)
personHForm = renderBootstrap hConfig $ Person
    &lt;$&gt; areq textField (bootstrapFieldHelper hConfig &quot;Name&quot; (Just &quot;Person name&quot;)) Nothing
    &lt;*&gt; areq textField (bootstrapFieldHelper hConfig &quot;Surname&quot; (Just &quot;Person surname&quot;)) Nothing

personIForm :: Html -&gt; MForm Handler (FormResult Person, Widget)
personIForm = renderBootstrap iConfig $ Person
    &lt;$&gt; areq textField (bootstrapFieldHelper iConfig &quot;Name&quot; (Just &quot;Person name&quot;)) Nothing
    &lt;*&gt; areq textField (bootstrapFieldHelper iConfig &quot;Surname&quot; (Just &quot;Person surname&quot;)) Nothing

personForm :: Html -&gt; MForm Handler (FormResult Person, Widget)
personForm = renderBootstrap bConfig $ Person
    &lt;$&gt; areq textField (bootstrapFieldHelper bConfig &quot;Name&quot; (Just &quot;Person name&quot;)) Nothing
    &lt;*&gt; areq textField (bootstrapFieldHelper bConfig &quot;Surname&quot; (Just &quot;Person surname&quot;)) Nothing

largeDataForm :: Html -&gt; MForm Handler (FormResult LargeData, Widget)
largeDataForm = renderBootstrap largeFormConfig $ LargeData
    &lt;$&gt; areq textField (bootstrapFieldHelper hConfig &quot;Text&quot; (Just &quot;Some text content&quot;)) Nothing
    &lt;*&gt; areq intField (bootstrapFieldHelper hConfig &quot;Int&quot; (Just &quot;Some integer value&quot;)) Nothing
    &lt;*&gt; areq doubleField (bootstrapFieldHelper hConfig &quot;Double&quot; (Just &quot;Some double value&quot;)) Nothing
    &lt;*&gt; areq textareaField (bootstrapFieldHelper hConfig &quot;Area&quot; (Just &quot;Some text area content&quot;)) Nothing
    &lt;*&gt; areq hiddenField (bootstrapFieldHelper hConfig &quot;Hidden&quot; (Just &quot;Hidden field&quot;)) Nothing
    &lt;*&gt; areq passwordField (bootstrapFieldHelper hConfig &quot;Password&quot; (Just &quot;Password field&quot;)) Nothing
    &lt;*&gt; areq emailField (bootstrapFieldHelper hConfig &quot;Email&quot; (Just &quot;Email field&quot;)) Nothing
    &lt;*&gt; areq htmlField (bootstrapFieldHelper hConfig &quot;Html&quot; (Just &quot;Some HTML&quot;)) Nothing
    &lt;*&gt; areq dayField (bootstrapFieldHelper hConfig &quot;Day&quot; (Just &quot;Some day&quot;)) Nothing
    &lt;*&gt; areq timeField (bootstrapFieldHelper hConfig &quot;Time&quot; (Just &quot;Some time&quot;)) Nothing
    &lt;*&gt; areq (searchField False) (bootstrapFieldHelper hConfig &quot;Search&quot; (Just &quot;Some search&quot;)) Nothing
    &lt;*&gt; areq urlField (bootstrapFieldHelper hConfig &quot;URL&quot; (Just &quot;Some URL&quot;)) Nothing
    &lt;*&gt; areq boolField (bootstrapFieldHelper hConfig &quot;Bool&quot; (Just &quot;Some bool&quot;)) Nothing
    &lt;*&gt; areq checkBoxField (bootstrapFieldHelper hConfig &quot;Checkbox&quot; (Just &quot;Some checkbox&quot;)) Nothing

{-# START_FILE Dispatch.hs #-}

{-# LANGUAGE TemplateHaskell #-}

module Dispatch where

import Yesod

import Foundation

import Handler.Home

mkYesodDispatch &quot;FormApp&quot; resourcesFormApp

{-# START_FILE Handler/Home.hs #-}

{-# LANGUAGE MultiParamTypeClasses #-}
{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE TypeFamilies #-}
{-# LANGUAGE TemplateHaskell #-}

module Handler.Home where

import          Yesod
import          Yesod.Default.Util
import          Yesod.Form.Jquery

import          Foundation

getHomeR :: Handler Html
getHomeR = do
    (basicWidget, enctype) &lt;- generateFormPost personForm
    (inlineWidget, enctype) &lt;- generateFormPost personIForm
    (horizontalWidget, enctype) &lt;- generateFormPost personHForm
    (largeWidget, enctype) &lt;- generateFormPost largeDataForm
    defaultLayout $ do
        addStylesheetRemote &quot;//netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css&quot;
        $(widgetFileReload def &quot;home&quot;)

{-# START_FILE Main.hs #-}

module Main where

import          Yesod
import          Yesod.Form.Jquery

import          Foundation
import          Dispatch

main :: IO ()
main = warpEnv FormApp

{-# START_FILE Form/Bootstrap3.hs #-}

{-# LANGUAGE QuasiQuotes #-}
{-# LANGUAGE OverloadedStrings #-}

module Form.Bootstrap3 (renderBootstrap,
                        bootstrapFieldSettings,
                        BootstrapFormConfig (..),
                        GridOptions (..),
                        BootstrapForm (..)
                        ) where

import              Yesod hiding (renderBootstrap)

import              Data.Maybe (listToMaybe, fromMaybe)

import              Data.Text (Text, pack)

import              Text.Blaze.Html

data GridOptions = ColXs Int | ColSm Int | ColMd Int | ColLg Int

instance Show GridOptions where
    show (ColXs 0) = &quot;&quot;
    show (ColXs columns) = &quot;col-xs-&quot; ++ show columns

    show (ColSm 0) = &quot;&quot;
    show (ColSm columns) = &quot;col-sm-&quot; ++ show columns

    show (ColMd 0) = &quot;&quot;
    show (ColMd columns) = &quot;col-md-&quot; ++ show columns

    show (ColLg 0) = &quot;&quot;
    show (ColLg columns) = &quot;col-lg-&quot; ++ show columns

instance ToMarkup GridOptions where
    toMarkup = toMarkup . show

toOffset :: GridOptions -&gt; String
toOffset (ColXs 0) = &quot;&quot;
toOffset (ColSm 0) = &quot;&quot;
toOffset (ColMd 0) = &quot;&quot;
toOffset (ColLg 0) = &quot;&quot;
toOffset (ColXs columns) = &quot;col-xs-offset-&quot; ++ show columns
toOffset (ColSm columns) = &quot;col-sm-offset-&quot; ++ show columns
toOffset (ColMd columns) = &quot;col-md-offset-&quot; ++ show columns
toOffset (ColLg columns) = &quot;col-lg-offset-&quot; ++ show columns

data BootstrapForm = BootstrapBasicForm | BootstrapInlineForm
    | BootstrapHorizontalForm { containerOffset :: GridOptions, container :: GridOptions, label :: GridOptions }

data BootstrapFormConfig = BootstrapFormConfig { form :: BootstrapForm, submit :: String }

bootstrapFieldSettings :: BootstrapFormConfig -&gt; SomeMessage site -&gt; Maybe (SomeMessage site)
    -&gt; Maybe Text -&gt; Maybe Text -&gt; Maybe Text -&gt; FieldSettings site
bootstrapFieldSettings formConfig msg tooltip placeholder id name =
    FieldSettings msg tooltip id name (attrsFromFormConfig formConfig placeholder)

attrsFromFormConfig :: BootstrapFormConfig -&gt; Maybe Text -&gt; [(Text, Text)]
attrsFromFormConfig _ Nothing = [(&quot;class&quot;, &quot;form-control&quot;)]
attrsFromFormConfig _ (Just placeholder) = [(&quot;class&quot;, &quot;form-control&quot;), (&quot;placeholder&quot;, placeholder)]

renderBootstrap :: Monad m =&gt; BootstrapFormConfig -&gt; FormRender m a
renderBootstrap formConfig aform fragment = do
    (res, views') &lt;- aFormToForm aform
    let views = views' []
        has (Just _) = True
        has Nothing  = False
        widget = [whamlet|
                        \#{fragment}
                        $forall view &lt;- views
                          &lt;div .form-group :fvRequired view:.required :not $ fvRequired view:.optional :has $ fvErrors view:.error&gt;
                            $case (form formConfig)
                              $of BootstrapBasicForm
                                &lt;label for=#{fvId view}&gt;#{fvLabel view}
                                ^{fvInput view}
                                ^{helpWidget view}
                              $of BootstrapInlineForm
                                &lt;label .sr-only for=#{fvId view}&gt;#{fvLabel view}
                                ^{fvInput view}
                                ^{helpWidget view}
                              $of BootstrapHorizontalForm containerOffset containerClass labelClass
                                &lt;label .control-label .#{labelClass} for=#{fvId view}&gt;#{fvLabel view}
                                &lt;div .#{containerClass}&gt;
                                  ^{fvInput view}
                                ^{helpWidget view}

                        ^{submitWidget $ formConfig}
                |]
    return (res, widget)

submitWidget (BootstrapFormConfig (BootstrapHorizontalForm containerOffset containerClass labelClass) submit) = [whamlet|
&lt;div .form-group&gt;
    &lt;div .#{toOffset containerOffset} .#{containerClass}&gt;
      &lt;button type=submit .btn .btn-default&gt;#{submit}
|]
submitWidget (BootstrapFormConfig _ submit) = [whamlet|&lt;button type=submit .btn .btn-default&gt;#{submit}|]

helpWidget view = [whamlet|
    $maybe tt &lt;- fvTooltip view
      &lt;span .help-block&gt;#{tt}
    $maybe err &lt;- fvErrors view
      &lt;span .help-block&gt;#{err}
|]

{-# START_FILE config/routes #-}

/           HomeR       GET

{-# START_FILE templates/home.hamlet #-}

&lt;div .container&gt;

    &lt;div .jumbotron&gt;
        &lt;h2&gt;An example of a basic form
        &lt;div .container&gt;
            &lt;form method=get action=@{HomeR} enctype=#{enctype}&gt;
                ^{basicWidget}

    &lt;div .jumbotron&gt;
        &lt;h2&gt;An example of an inline form
        &lt;div .container&gt;
            &lt;form .form-inline method=get action=@{HomeR} enctype=#{enctype}&gt;
                ^{inlineWidget}

    &lt;div .jumbotron&gt;
        &lt;h2&gt;An example of a horizontal form
        &lt;div .container&gt;
            &lt;form .form-horizontal method=get action=@{HomeR} enctype=#{enctype}&gt;
                ^{horizontalWidget}

    &lt;div .jumbotron&gt;
        &lt;h2&gt;An example of a large horizontal form
        &lt;div .container&gt;
            &lt;form .form-horizontal method=get action=@{HomeR} enctype=#{enctype}&gt;
                ^{largeWidget}
</code></pre><h2 id="things-that-are-missing---"><a href="#things-that-are-missing---">Things that are missing...</a></h2><p>...are numerous:</p><ul><li>showing tooltips breaks inline forms</li><li>support for some input controls is missing (groups of checkboxes and radiobuttons, file inputs etc.)</li><li>placeholder attribute for fields is a <code>Maybe Text</code>, but should support i18n</li><li>other things I probably forgot and don't know</li></ul><p>This was, after all, a simple exercise in making some basic functionality that I'll continue to use in the near future, at least until a better solution pops up.</p><p>There is a companion project for the tutorial <a href="https://www.fpcomplete.com/user/msrdic/bootstrap-3-forms-with-yesod">here</a> and the complete source is on <a href="https://github.com/msrdic/yesod-forms">github</a>. Hope you find it useful.</p></article>


</div>
</div>
<div class="row article-footer"><div class="span7 meta"><span class="sociallinksunicode social">
<a href="https://twitter.com/home?status=$url$" target="_blank"><i class="icon-twitter"></i></a>&nbsp;
<a href="http://www.facebook.com/sharer/sharer.php?u=$url$" target="_blank"><i class="icon-facebook"></i></a>&nbsp;
<a href="https://plus.google.com/share?url=$url$" target="_blank"><i class="icon-google-plus"></i></a></span>
</div>
</div>
</div>
<div class="footer"><div class="container"><div class="row"><div class="span12"><ul class="menu"><li><a href="https://www.schoolofhaskell.com/">School</a>
</li>
<li><a href="https://www.schoolofhaskell.com/user">Users</a>
</li>

<li><a class="brand" href="https://fpcomplete.com">Sponsored by:
<img src="/static/img/logo.png" title="FPComplete">
</a>
</li>
</ul>
</div>
</div>
<div class="row"><div class="span12"></div>
</div>
</div>
</div>
<link rel="stylesheet" type="text/css" href="/static/bootstrap/css/bootstrap-responsive.css" />
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script><script src="https://www.schoolofhaskell.com/static/combined/Y-3k9_tW.js"></script><script>$(function(){
  $("a.logout").click(function(){
    var form = $("<form method='post'/>");
    form.attr("action", $(this).attr("href"));
    $("body").append(form);
    form.submit();
    return false;
  });
});

$(function(){
    $('.sociallinksunicode a').each(function(){
        $(this).attr('href',$(this).attr('href').replace('$url$',document.location));
    });
});

$(function(){
  // If we need to select a user/select a password then show the
  // details confirmation form, otherwise enable the getting started
  // section.
  if($('.alert-block a').text().match(/(selected a username|change your password)/)) {
    $("#confirm-details").show();
    $("#confirm-details #inputUsername").focus();
  } else {
    $("#get-started").removeClass('disabled').addClass('enabled');
  }

  // For lack of a plain HTML validation story this will do.
  $('.welcome-page').each(function(){
    $('form').submit(check);
  });
  function check(){
    setTimeout(check,500);
    var error = false;
    $('.error').removeClass('error');
    $('#enter-details input').each(function(){
      if($(this).val() == '') {
        $(this).parent().parent().addClass('error');
        error = true;
      }
    });
    if(error) return false;
    if($('[name=password]').val() == $('[name=confirm]').val()) {
      $('#confirm').removeClass('error');
      return true;
    } else {
      $('#confirm').addClass('error');
      return false;
    }
  }
});

$(function(){
  // When scrolling over a snippet editor, activate the "clone in IDE" popovers
  $('article').each(function(){
    var n = 100;
    var wait = 10000;
    function check(){
      if($('.clone').length == 0) {
        setTimeout(check,n);
        return;
      }
      var activated = $.cookie('clone-popover');
      if (activated) return;
      var activate = false;
      $('.controlsRun:onScreen').each(function(){
        $.cookie('clone-popover', 'true', { expires: 30, path: '/' });
        activate = true;
        return false;
      });
      if(activate) {
          $('.clone').each(function(){
              // The bootstrap API is rather unreasonable to say the
              // least.
              next = $(this).parent();
              var title = next.attr('title');
              next.attr('data-content',$(this).attr('data-content'));
              next.attr('title',$(this).attr('title'));
              next.popover('show',{
                  title: $(this).attr('title')
              });
              next.attr('title',title);
          });
          setTimeout(function(){
              $('.clone').each(function(){
                  $(this).parent().popover('hide');
              });
          },wait);
      } else {
        setTimeout(check,n);
      }
    }
    setTimeout(check,n);
  });
});

// onScreen jQuery plugin v0.2.1
// (c) 2011-2013 Ben Pickles
//
// http://benpickles.github.com/onScreen
//
// Released under MIT license.
(function(a){a.expr[":"].onScreen=function(b){var c=a(window),d=c.scrollTop(),e=c.height(),f=d+e,g=a(b),h=g.offset().top,i=g.height(),j=h+i;return h>=d&&h<f||j>d&&j<=f||i>e&&h<=d&&j>=f}})(jQuery);

/*!
 * jQuery Cookie Plugin v1.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
(function($, document) {

  var pluses = /\+/g;
  function raw(s) {
    return s;
  }
  function decoded(s) {
    return decodeURIComponent(s.replace(pluses, ' '));
  }

  $.cookie = function(key, value, options) {

    // key and at least value given, set cookie...
    if (arguments.length > 1 && (!/Object/.test(Object.prototype.toString.call(value)) || value == null)) {
      options = $.extend({}, $.cookie.defaults, options);

      if (value == null) {
	options.expires = -1;
      }

      if (typeof options.expires === 'number') {
	var days = options.expires, t = options.expires = new Date();
	t.setDate(t.getDate() + days);
      }

      value = String(value);

      return (document.cookie = [
	encodeURIComponent(key), '=', options.raw ? value : encodeURIComponent(value),
	options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE
	options.path    ? '; path=' + options.path : '',
	options.domain  ? '; domain=' + options.domain : '',
	options.secure  ? '; secure' : ''
      ].join(''));
    }

    // key and possibly options given, get cookie...
    options = value || $.cookie.defaults || {};
    var decode = options.raw ? raw : decoded;
    var cookies = document.cookie.split('; ');
    for (var i = 0, parts; (parts = cookies[i] && cookies[i].split('=')); i++) {
      if (decode(parts.shift()) === key) {
	return decode(parts.join('='));
      }
    }
    return null;
  };
  $.cookie.defaults = {};})(jQuery, document);
</script><!--[if lt IE 10]><script src="https://www.schoolofhaskell.com/static/design/js/ie.js?etag=ayV2DuJ0"></script><![endif]--><script>if(!window.location.href.match(/localhost/)){var track = '/tutorial/user/msrdic/bootstrap-3-forms-with-yesod-1';
window._gaq = [['_setAccount','UA-36928035-1'],track != ''? ['_trackPageview',track] : ['_trackPageview']
,['_trackPageLoadTime']];window._gaq.push(['_setCustomVar',1,'Section','School of Haskell',3]);
window._gaq.push(['_setCustomVar',2,'User Type','Visitor',1]);
(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);

})();}</script>
<!-- Prompt IE 6 users to install Chrome Frame. Remove this if you want to support IE 6.  chromium.org/developers/how-tos/chrome-frame-getting-started --><!--[if lt IE 7 ]><script src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script><script>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script><![endif]--></body></html>