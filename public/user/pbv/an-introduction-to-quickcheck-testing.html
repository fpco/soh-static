<!DOCTYPE html>
<html><head><title>An introduction to QuickCheck testing - School of Haskell | School of Haskell</title><meta http-equiv="x-ua-compatible" content="IE=9"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="google-site-verification" content="Rfxk2TdeMMXEXHgJ2_OO8Rt3hPbQSDao0OXQV_n6z_s" /><link href="//fonts.googleapis.com/css?family=Merriweather" rel="stylesheet" type="text/css"><link href="https://www.schoolofhaskell.com/recent-content/feed" type="application/rss+xml" rel="alternate" title="Recently published content">
<link rel="stylesheet" href="https://www.schoolofhaskell.com/static/combined/UlwEHVcM.css"><style>.social{margin-right:1em}h1{font-family:Merriweather !important}article{font-family:Merriweather !important}article li{font-family:Merriweather !important;line-height:1.6em}h1,h2,h3,h4,h4,h5{font-family:Merriweather !important}.editor p{font-family:Frutiger, "Frutiger Linotype", Univers, Calibri, "Gill Sans", "Gill Sans MT", "Myriad Pro", Myriad, "DejaVu Sans Condensed", "Liberation Sans", "Nimbus Sans L", Tahoma, Geneva, "Helvetica Neue", Helvetica, Arial, sans-serif}.article-footer{border-top:1px solid #ddd;padding-top:1em;margin-top:1em}body{font-size:16px !important}.navbar .navbar-inner{background:#3c3f41}.navbar .brand{font-size:14px}.navbar .brand img{width:6em}.navbar .icon-wrench{margin:0 -0.5em 0 -0.5em;padding:0 1em 0 1em;height:20px}.navbar-inverse .nav .active a{background:#333638}.navbar-inverse .nav > li > a{color:#a7a7a7
}.navbar-inverse .btn-navbar{background:#333638}.navbar-inverse .nav > li a:hover,.navbar-inverse .btn{background:#333537 !important}@media (max-width: 979px) {.icon-wrench{padding-left:1em !important}}.breadcrumb{border-top-left-radius:0;border-top-right-radius:0}h1{margin-top:20px}.breadcrumb-container + .main-content h1{margin-top:0}.footer{padding:30px 0;margin-top:70px;border-top:1px solid #e5e5e5;background-color:#f5f5f5}.footer ul.footer-menu{list-style-type:none}.footer ul.footer-menu li{display:inline-block}.footer ul.footer-menu li + li{margin-left:0.5em}.footer ul.footer-menu li + li:before{margin-right:0.5em;content:"Â·";color:#999}.footer ul.menu li{display:inline-block}.footer ul.menu li + li{margin-left:0.5em}.footer .copyright{margin-left:25px}.main-content{min-height:100%}.gravatar{width:80px;height:80px;border-radius:2px;background:#eee}.empty-gravatar{width:0}.container{font-family:"Segoe UI", Candara, "Bitstream Vera Sans", "DejaVu Sans", "Bitstream Vera Sans", "Trebuchet MS", Verdana, "Verdana Ref", sans-serif}.container h1,.container h2,.container h4,.container h4,.container h5{font-family:"Segoe UI", Candara, "Bitstream Vera Sans", "DejaVu Sans", "Bitstream Vera Sans", "Trebuchet MS", Verdana, "Verdana Ref", sans-serif}article{font-family:Merriweather !important}article h1{font-family:Merriweather !important}article li{font-family:Merriweather !important;line-height:1.6em}article li + li{margin-top:0.5em}article div.code{background:#f9f9f9;border:1px solid #d1d1d1;position:relative;border-radius:0.2em;margin:0.25em 0 0.75em 0;min-height:2.5em}article code{color:#005580;font-size:14px;white-space:pre}article a.hoogle > code{color:#0088cc;font-size:14px;white-space:pre;border:0}article .expand-code{display:none}article pre{overflow:auto;word-wrap:normal}article code.active{display:block;max-height:430px}article h1{font-size:31.5px}article h3{font-size:17.5px}article h4{font-size:14px}article h5,article h6{font-size:11.9px}article p{line-height:1.7em}article h1 code,article h2 code,article h3 code,article h4 code,article h5 code,article h6 code{font-size:inherit !important}article h1 a,article h2 a,article h3 a,article h4 a,article h5 a,article h6 a{color:#444}article h1 a:before,article h2 a:before,article h3 a:before,article h4 a:before,article h5 a:before,article h6 a:before{margin-left:-1.5em;padding-right:0.5em;font-family:fontawesome;content:"\f0c1";font-size:20px;color:#fff}article h1 a:hover,article h2 a:hover,article h3 a:hover,article h4 a:hover,article h5 a:hover,article h6 a:hover{text-decoration:none;color:#0088cc}article h1 a:hover:before,article h2 a:hover:before,article h3 a:hover:before,article h4 a:hover:before,article h5 a:hover:before,article h6 a:hover:before{color:#888}article h2{font-size:24.5px}article .popover{font-family:actor}article .popover h3.popover-title{font-family:actor !important;font-size:1em}article .popover .popover-content{width:15em;font-size:1em}article .controlsRun{display:block;padding:0.5em;text-align:right;background:#f2f2f2}article .controlsRun a.clone{margin-right:1em;font-family:actor;text-decoration:none}article .controlsRun a.clone span{padding-left:0.5em}article .controlsRun a.run,article .controlsRun a.reset,article .controlsRun a.show-code{font-size:16px}article .controlsRun a.run span,article .controlsRun a.reset span,article .controlsRun a.show-code span{display:none}article .controlsRun a.reset{margin-left:0.5em;color:#a2becc}article .controlsRun a.reset{display:none}article .controlsRun a.show-code{margin-right:0.75em}article .controlsRun a.run:hover,article .controlsRun a.show-code:hover{text-decoration:none}article .controlsRun a.show-code.active{color:#DC0D0D}article .controlsRun a[disabled]{color:#a2becc;cursor:default}article .collapse-area .collapse-header{background:#0088cc;color:#fff;padding:0.3em;cursor:pointer}article .collapse-area .hidden-toggle:before{content:"\f0d7";font-family:fontawesome;margin-right:0.5em;margin-left:0.25em}article .collapse-area .collapsed-files{overflow:auto;height:auto}article .collapse-area.collapse-disabled{display:none}article .collapse-area.collapse-area-off .collapsed-files{height:0px;overflow:hidden}article .collapse-area.collapse-area-off .hidden-toggle:before{content:"\f0da"}article .snippet-stdio .stdout{margin:0.5em;padding-right:2em;position:relative;word-wrap:break-word}article .snippet-stdio .stdin{-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;-webkit-transition:none;-moz-transition:none;-o-transition:none;transition:none;padding:0;margin:0}article .hoogle-results{margin:0.25em}article .hoogle-results .hoogle-inner{background:#fff;padding:0.5em;border-radius:3px;border:1px solid #ddd}article .hoogle-results .hoogle-inner .close-link{position:relative;float:right;margin-top:-0.5em;margin-right:-0.5em}article .snippet-output-errors{margin:1em 0.5em 0.5em 0.5em;position:relative}article .snippet-output-errors ul{list-style-type:none;margin:0;position:relative}article .snippet-output-errors pre{border:0;border-radius:0;padding:0.25em;margin:0;background:inherit;color:inherit}article .snippet-output-errors .close-link{color:inherit;background:inherit}article .snippet-editors{z-index:0;padding:0.25em}article .close-link{padding:0.5em;background:#eaeaea;border-bottom-left-radius:0.2em;border-top-right-radius:0.2em;position:absolute;top:0;right:0}article .close-link:hover{text-decoration:none}article .snippet-title{padding:0.5em 0 0 0.5em}article .snippet-title .snippet-icon{font-family:FontAwesome;display:inline-block;margin-right:0.5em}article .fullModuleCode + div .snippet-title{margin-top:0.5em;border-top:1px solid #ccc;padding-top:0.5em}article .CodeMirror{height:auto;min-height:1em;line-height:1.5em;background:transparent;font-size:14px !important}article .CodeMirror .highlighted{background:rgba(250, 210, 0, 0.45) !important}article .CodeMirror-widget{margin-left:2em;line-height:1.8}article .CodeMirror.collapsed{height:10em !important}article .editor .expander{text-align:center;display:block;padding:0.5em;text-decoration:none;border-bottom-left-radius:2px;border-bottom-right-radius:2px}article .editor .expander .ellipsis{background:white;border:1px solid #ccc;padding:0 0.5em;height:1em;line-height:0.5em;display:inline-block;color:#555;cursor:pointer}article .editor .expander .ellipsis:hover{background:#ddd;color:#333}article .web-runner{margin:0.5em;padding:0.5em;border:1px solid #ccc;border-radius:3px;background:#f5f5f5}article .web-runner iframe{border:0;margin-top:0.5em;margin-bottom:0;background:white}article .web-runner .controls i{cursor:pointer;color:#0088cc}article .web-runner .controls i:hover{color:#222}article .web-runner .controls i + i{margin-left:0.5em}article .web-runner .controls .icon-remove{float:right}article .hidden{display:block;visibility:visible}article .controlsShowHide{margin-bottom:0.5em}.tutorial-body{float:left !important}.tutorial-nav{float:right !important}@media (max-width: 979px) {.related-content{float:right}.author-name{display:block;margin-left:20px !important;padding-left:5px;margin-top:5px}article h1 a:hover:before,article h2 a:hover:before,article h3 a:hover:before,article h4 a:hover:before,article h5 a:hover:before,article h6 a:hover:before{color:#fff}.tutorial-nav{float:none !important;width:auto !important}.tutorial-body{float:none !important;width:auto !important}}@media (min-width: 980px) and (max-width: 1199px) {.navbar-search{display:none}.tutorial-nav{width:200px}.tutorial-body{width:720px}}#accountPage h1{margin:20px 0 0 0}#accountPage h2{font-size:20px}.group-contents .span8{float:left}.group-contents .span4{float:right}.container > .alert-block{margin-top:1em}.alert{color:#aa874a
}.social{margin-bottom:.8em;display:block}.social a{text-decoration:none}.social i{font-size:1.1em;color:#fff;padding:0.25em;border-radius:0.25em;width:1em;display:inline-block;text-align:center}.social i.icon-twitter{background:#0088cc}.social i.icon-facebook{background:#3b5998
  }.social i.icon-google-plus{background:#dd4b39
  }.well pre{background:#fcfcfc}.well h2{margin-top:0}code{color:#005580;font-size:14px;white-space:pre}</style><!--[if lt IE 8]><link rel="stylesheet" href="https://www.schoolofhaskell.com/static/design/css/ie7.css?etag=TSMl9x1V"><![endif]--><!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]--></head><body class="not-logged-in" itemscope itemtype="http://schema.org/Product"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-H62P" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-H62P');</script><div class="navbar navbar-inverse navbar-static-top"><div class="navbar-inner"><div class="container"><a class="btn btn-navbar" type="button" data-toggle="collapse" data-target=".nav-collapse"><span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</a>
<a class="brand" href="/"><img src="/static/img/haskell-logo-wide.png" title="School of Haskell">
</a>
<div class="nav-collapse collapse"><ul class="nav"><li><a href="https://www.schoolofhaskell.com/">School</a>
</li>
<li><a href="https://www.schoolofhaskell.com/user">Users</a>
</li>
</ul>
<form class="navbar-search pull-left" action="https://www.schoolofhaskell.com/search"><input class="search-query" type="text" placeholder="Search" name="search">
</form>
</div>
</div>
</div>
</div>
<div class="container breadcrumb-container"><div class="row"><div class="span12"><ul class="breadcrumb"><li><a href="https://www.schoolofhaskell.com/user/pbv">Pedro Vasconcelos</a>
<span class="divider">/</span>
</li>
<li><a href="https://www.schoolofhaskell.com/user/pbv/an-introduction-to-quickcheck-testing">An introduction to QuickCheck testing</a>
</li>
</ul>
</div>
</div>
</div>
<div class="container main-content"><div class="row"><div class="span12"><h1 itemprop="name">An introduction to QuickCheck testing</h1>
</div>
</div>
<div class="row"><div class="span7 meta"><p><span class="date">24 Apr 2015</span>
<span class="author"><a href="https://www.schoolofhaskell.com/user/pbv">Pedro Vasconcelos</a>
</span>
<span class="view-edit-link pull-right"><a class="view-source-link" href="https://www.schoolofhaskell.com/tutorial-raw/2424/db9f17f9a3805ee46f5d176fd74b816cfae300b4">View Markdown source</a>
</span>
</p>
<p class="tags"></p>
</div>
</div>
<div class="row"><div class="span7 meta"><span class="sociallinksunicode social">
<a href="https://twitter.com/home?status=$url$" target="_blank"><i class="icon-twitter"></i></a>&nbsp;
<a href="http://www.facebook.com/sharer/sharer.php?u=$url$" target="_blank"><i class="icon-facebook"></i></a>&nbsp;
<a href="https://plus.google.com/share?url=$url$" target="_blank"><i class="icon-google-plus"></i></a></span>
</div>
</div>
<p class="alert">As of March 2020, School of Haskell has been switched to read-only mode.</p>
<div class="row" itemprop="desc"><div class="span4 tutorial-nav"><div class="related-content"><ul class="nav nav-tabs nav-stacked"><li><script>reddit_target='fpcomplete'</script>
<script src="https://redditstatic.s3.amazonaws.com/button/button1.js"></script>
</li>
<li><a href="https://www.schoolofhaskell.com/user/pbv/a-regular-expression-matcher">Next content: A regular expression matcher</a>
</li>
<li><a href="https://www.schoolofhaskell.com/user/pbv">See all content by Pedro Vasconcelos</a>
</li>
</ul>

</div>
<div class="aside"><h3>Sections</h3>
<ul><li><a href="#proving-versus-testing-programs">Proving versus testing programs</a></li><li><a href="#a-case-study--string-splitting">A case-study: string splitting</a><ul><li><a href="#manual-testing">Manual testing</a></li><li><a href="#thinking-about-properties">Thinking about properties</a></li><li><a href="#a-first-attempt">A first attempt</a></li><li><a href="#more-thorough-testing">More thorough testing</a></li><li><a href="#fixing-split">Fixing split</a></li></ul></li><li><a href="#conclusion">Conclusion</a></li></ul></div>
</div>
<div class="span8 tutorial-body" data-environment="ghc-7.8-stable-14.09">
<article><h1 id="proving-versus-testing-programs"><a href="#proving-versus-testing-programs">Proving <i>versus</i> testing programs</a></h1><p>One of the advantages of the purely-functional
paradigm over the imperative or object-oriented ones is that
functional programs are easier to reason about.
For example, consider the following distributivity 
law between <code>reverse</code> and <code>++</code>:</p><pre><code class="haskell">reverse (xs++ys) = reverse ys ++ reverse xs</code></pre><p>We can prove that this property holds for all finite lists 
using only high-school algebra and induction. In fact, such techniques
have been taught in first-year university courses on 
functional programming since the 1980s.</p><p>But properties can also be used for <i>testing</i> programs when you 
don't want to invest the effort to do a formal proof. 
<i>QuickCheck</i> is an excelent Haskell library that allows
expressing properties about programs and testing them with 
randomly-generated values.</p><p>A property for QuickCheck is simply a truth-valued 
function whose arguments are implicitly universally quantified.
The library exports function called <code>quickCheck</code> 
that tests a property with 100 randomly-generated values (by default). 
QuickCheck uses types to generate test data, starting with
short lists and small integers and generating progressively larger
values.
If the property fails for some value, a counter-example is shown; 
otherwise the test succeeds.</p><p>Run the code bellow to test our distributivity law for <code>reverse</code>.</p><pre><code class="active haskell">import Test.QuickCheck

prop_revapp :: [Int] -&gt; [Int] -&gt; Bool
prop_revapp xs ys = reverse (xs++ys) == reverse xs ++ reverse ys

main = quickCheck prop_revapp</code></pre><p>The tests failed! Can you spot what is wrong?</p><div class="hidden"><p>The expression in the right-hand side of <code>prop_revapp</code> is incorrect: I've intentionally 
switched  <i>xs</i> with <i>ys</i>. Fix it and try running the tests again.</p></div><p>The failure of the test case above shows another cool QuickCheck feature: when
a counter-example is found, QuickCheck attempts to shorten it
before presenting using a <i>shrinking</i> heuristic.
This is great because randomly-generated data contains a lot of 
uninformative &quot;noise&quot;; a short counter-example is much more useful
for debugging our programs.</p><p>In the test above QuickCheck actually found the <i>minimal</i> 
counter-example: the wrong equation still holds trivally
if either of the lists is empty
or if they contain identical values (e.g. if both lists are <code>[0]</code>)
but fails for <code>[0]</code> and <code>[1]</code>.</p><h1 id="a-case-study--string-splitting"><a href="#a-case-study--string-splitting">A case-study: string splitting</a></h1><p>Consider the following list processing problem I gave my first-year functional
programming students:</p><blockquote><p>Define a recursive function <code>split :: Char -&gt; String -&gt; [String]</code> that
breaks a string into substrings delimited by a given character.
Some usage examples:</p><pre><code class="haskell">split '@' &quot;pbv@dcc.fc.up.pt&quot; = [&quot;pbv&quot;,&quot;dcc.fc.up.pt&quot;]
split '/' &quot;/usr/include&quot; = [&quot;&quot;, &quot;usr&quot;, &quot;include&quot;]</code></pre><p>Sugestion: use the <code>takeWhile</code> and <code>dropWhile</code> functions from the 
standard Prelude.</p></blockquote><p>The sugestion is to use some standard higher-order functions 
from the Prelude to break the string recursively. Here's an
initial attempt at a solution:</p><pre><code class="haskell">split c [] = []
split c xs = xs' : if null xs'' then [] else split c (tail xs'')
    where xs' = takeWhile (/=c) xs
          xs''= dropWhile (/=c) xs
</code></pre><p>However, the above definition has one subtle mistake.
Let us employ testing to spot and correct the bug.</p><h2 id="manual-testing"><a href="#manual-testing">Manual testing</a></h2><p>Let us start by testing the defintion with a few sample
cases:</p><pre><code class="active haskell">split c [] = []
split c xs = xs' : if null xs'' then [] else split c (tail xs'')
    where xs' = takeWhile (/=c) xs
          xs''= dropWhile (/=c) xs

-- show
examples = [('@',&quot;pbv@dcc.fc.up.pt&quot;), ('/',&quot;/usr/include&quot;)]

test (c,xs) = unwords [&quot;split&quot;, show c, show xs, &quot;=&quot;, show ys]
    where ys = split c xs

main = mapM_ (putStrLn.test) examples
-- /show</code></pre><p>Our two test cases gave the right answers.
At this point you might be able to guess some more interesting cases
to check for &quot;edge&quot; conditions (you may edit the <code>examples</code> list above).
But another issue is figuring out what the right answers should
be for such cases. This is not too difficult
for a simple function, but can be much harder for more 
complex problems --- even for experienced programmers.</p><p>Let us instead ask ourselves one question: 
<i>can we think of general properties that <code>split</code> should satisfy</i>?</p><h2 id="thinking-about-properties"><a href="#thinking-about-properties">Thinking about properties</a></h2><p>We can devise a property for <code>split</code> by consider the <i>inverse
function</i> of <code>split</code> which I shall call <code>unsplit</code>. 
Here are some examples of what we want <code>unsplit</code> to do:</p><pre><code class="haskell">unsplit '@' [&quot;pbv&quot;, &quot;dcc.fc.up.pt&quot;] = &quot;pbv@dcc.fc.up.pt&quot;
unsplit '/' [&quot;&quot;, &quot;usr&quot;, &quot;include&quot;] = &quot;/usr/include&quot;</code></pre><p>Generalizing from such examples we can define <code>unsplit</code> as
the composition of</p><a class="hoogle" href="https://www.stackage.org/lts/hoogle?q=Prelude.concat" title="Hoogle search for: Prelude.concat"><code>concat</code></a>
and <a class="hoogle" href="https://www.stackage.org/lts/hoogle?q=Data.List.intersperse" title="Hoogle search for: Data.List.intersperse"><code>intersperse</code></a>
(from `Data.List`).<pre><code class="haskell">unsplit :: Char -&gt; [String] -&gt; String
unsplit c = concat . intersperse [c]</code></pre><p>We can now express one interesting property:
if we first split and then unsplit with the same delimiter,
we should get back the original string (i.e. <code>unsplit</code> is the left 
inverse of <code>split</code>).
This is expressed as the following QuickCheck property:</p><pre><code class="haskell">prop_split_inv c xs = unsplit c (split c xs) == xs</code></pre><p>You should convince yourself that the property above should hold for <i>all</i> characters
<i>c</i> and strings <i>xs</i> regarless of how many times <i>c</i> occurs in <i>xs</i> (including
zero occurences).</p><h2 id="a-first-attempt"><a href="#a-first-attempt">A first attempt</a></h2><p>We can now attempt to test <code>prop_join_split</code> using QuickCheck.</p><pre><code class="active haskell">import Test.QuickCheck
import Data.List (intersperse)

split :: Char -&gt; String -&gt; [String]
split c [] = []
split c xs = xs' : if null xs'' then [] else split c (tail xs'')
    where xs' = takeWhile (/=c) xs
          xs''= dropWhile (/=c) xs

unsplit :: Char -&gt; [String] -&gt; String
unsplit c = concat . intersperse [c]

-- show
prop_split_inv c xs = unsplit c (split c xs) == xs

main = quickCheck prop_split_inv
-- /show</code></pre><p>Most likely you have observed that 100 random tests passed
(or you may have hit a counter-example if you were lucky).
In any case, we should be aware of Dijkstra's remark
that <i>testing shows only the presence of bugs, not their absence</i>!</p><p>For random testing it is important to ensure that the
test data is reasonably distributed, otherwise we
simply get a false sense of security.
QuickCheck allows us to collect information on data distribution easily:
for example, let us collect the lengths of the <code>split</code> results.</p><pre><code class="active haskell">import Test.QuickCheck
import Data.List (intersperse)

split :: Char -&gt; String -&gt; [String]
split c [] = []
split c xs = xs' : if null xs'' then [] else split c (tail xs'')
    where xs' = takeWhile (/=c) xs
          xs''= dropWhile (/=c) xs

unsplit :: Char -&gt; [String] -&gt; String
unsplit c = concat . intersperse [c]

-- show
prop_split_inv c xs 
    = let ys = split c xs in 
      collect (length ys) $ unsplit c ys == xs

main = quickCheck prop_split_inv
-- /show</code></pre><p>The report shows that around 90% of the strings
are split into lists of length 0 or 1. 
This is because when both the delimiter <i>c</i> and string <i>xs</i> are
choosen independently it is unlikely that <i>c</i> occurs 
in <i>xs</i>, and if so, more than once.
The property might still fail for other cases, which
means we haven't tested our program thoroughly.</p><h2 id="more-thorough-testing"><a href="#more-thorough-testing">More thorough testing</a></h2><p>To conduct a more thorough testing we should modify 
our property slightly: select delimiters that <i>do</i> occur in the string.
We can do so with an explicit quantifier for choosing the delimiter.</p><pre><code class="active haskell">import Test.QuickCheck
import Data.List (intersperse)

split :: Char -&gt; String -&gt; [String]
split c [] = []
split c xs = xs' : if null xs'' then [] else split c (tail xs'')
    where xs' = takeWhile (/=c) xs
          xs''= dropWhile (/=c) xs

unsplit :: Char -&gt; [String] -&gt; String
unsplit c = concat . intersperse [c]

-- show
prop_split_inv xs
    = forAll (elements xs) $ \c -&gt; 
      unsplit c (split c xs) == xs

main = quickCheck prop_split_inv
-- /show</code></pre><p>This time we found a short counter-example very quickly
where the string contains a single delimiter character.</p><pre><code class="haskell">split 'a' &quot;a&quot; = [&quot;&quot;]
unsplit 'a' [&quot;&quot;] = &quot;&quot;</code></pre><p>This is a counter-example to our property because <code>&quot;a&quot; /= &quot;&quot;</code>. But what should we 
modify to fix the problem? In general, we would have three alternatives:</p><ol><li>modify the definition of <code>unsplit</code>;</li><li>modify the definition of <code>split</code>;</li><li>revise the property <code>prop_split_inv</code> to exclude such cases.</li></ol><p>In our case we can reject #1 and #3 because <code>unsplit</code> and <code>prop_split_inv</code> 
are short, self-evident definitions; hence we
will fix the definition of <code>split</code>.</p><h2 id="fixing-split"><a href="#fixing-split">Fixing split</a></h2><p>It it easy to see that our property will hold in the
counter-example case found if <code>split</code> gave the following result:</p><pre><code class="haskell">split 'a' &quot;a&quot; = [&quot;&quot;,&quot;&quot;]</code></pre><p>This implies that the equation defining <code>split</code> for the empty list
is wrong; it should instead be:</p><pre><code class="haskell">split c [] = [&quot;&quot;]</code></pre><p>Better still: we can just delete this equation altogether because 
the general case will give this result anyway after a single recursion step.
With this correction our solution passes all tests.</p><pre><code class="active haskell">import Test.QuickCheck
import Data.List (intersperse)

unsplit :: Char -&gt; [String] -&gt; String
unsplit c = concat . intersperse [c]

-- show
split :: Char -&gt; String -&gt; [String]
split c xs = xs' : if null xs'' then [] else split c (tail xs'')
    where xs' = takeWhile (/=c) xs
          xs''= dropWhile (/=c) xs

prop_split_inv xs
    = forAll (elements xs) $ \c -&gt; 
      unsplit c (split c xs) == xs

main = quickCheck prop_split_inv
-- /show</code></pre><p>Note that, considered in isolation, 
both definitions <code>split c []=[]</code> and <code>split c []=[&quot;&quot;]</code>
seem acceptable (our property holds for the empty string
in both cases); the first definition may appear simpler.
It is only when we consider the recursion as a whole that we
see that defining <code>split c []=[]</code> is <i>less orthogonal</i>
because it breaks our property for strings 
terminated by the delimiter character.</p><h1 id="conclusion"><a href="#conclusion">Conclusion</a></h1><p>QuickCheck is a great way to test Haskell programs, not just because
it allows conducting many tests cheaply, but mostly because
it encorages thinking about general properties that our code
should satisfy rather than just specific instances.
Thinking early about properties leads<br />to a cleaner, more orthogonal design (i.e., with
fewer arbitrarily-specified corner cases).</p><p>There is a lot more about QuickCheck that I have not covered
in this tutorial namely:</p><ul><li>writing custom generators and shrinking heuristic for user-defined data types;</li><li>controling the size of generated data;</li><li>controling the number of tests performed;</li><li>testing monadic code (e.g. in the IO or ST monad).</li></ul><p>For more information check the <a href="http://dl.acm.org/citation.cfm?id=351266&amp;CFID=317197023&amp;CFTOKEN=61604740">original QuickCheck paper</a>
or the <a href="http://dl.acm.org/citation.cfm?doid=636517.636527">one on monadic testing</a>; you should also lookup 
the <a class="hoogle" href="https://www.stackage.org/lts/hoogle?q=Test.QuickCheck" title="Hoogle search for: Test.QuickCheck"><code>QuickCheck library documentation</code></a>.</p></article>

<div id="disqus_thread"><script>var disqus_shortname = "fpcomplete"; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })();</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="https://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a></a>
</div>

</div>
</div>
<div class="row article-footer"><div class="span7 meta"><span class="sociallinksunicode social">
<a href="https://twitter.com/home?status=$url$" target="_blank"><i class="icon-twitter"></i></a>&nbsp;
<a href="http://www.facebook.com/sharer/sharer.php?u=$url$" target="_blank"><i class="icon-facebook"></i></a>&nbsp;
<a href="https://plus.google.com/share?url=$url$" target="_blank"><i class="icon-google-plus"></i></a></span>
</div>
</div>
</div>
<div class="footer"><div class="container"><div class="row"><div class="span12"><ul class="menu"><li><a href="https://www.schoolofhaskell.com/">School</a>
</li>
<li><a href="https://www.schoolofhaskell.com/user">Users</a>
</li>

<li><a class="brand" href="https://fpcomplete.com">Sponsored by:
<img src="/static/img/logo.png" title="FPComplete">
</a>
</li>
</ul>
</div>
</div>
<div class="row"><div class="span12"></div>
</div>
</div>
</div>
<link rel="stylesheet" type="text/css" href="/static/bootstrap/css/bootstrap-responsive.css" />
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script><script src="https://www.schoolofhaskell.com/static/combined/Y-3k9_tW.js"></script><script>$(function(){
  $("a.logout").click(function(){
    var form = $("<form method='post'/>");
    form.attr("action", $(this).attr("href"));
    $("body").append(form);
    form.submit();
    return false;
  });
});

$(function(){
    $('.sociallinksunicode a').each(function(){
        $(this).attr('href',$(this).attr('href').replace('$url$',document.location));
    });
});

$(function(){
  // If we need to select a user/select a password then show the
  // details confirmation form, otherwise enable the getting started
  // section.
  if($('.alert-block a').text().match(/(selected a username|change your password)/)) {
    $("#confirm-details").show();
    $("#confirm-details #inputUsername").focus();
  } else {
    $("#get-started").removeClass('disabled').addClass('enabled');
  }

  // For lack of a plain HTML validation story this will do.
  $('.welcome-page').each(function(){
    $('form').submit(check);
  });
  function check(){
    setTimeout(check,500);
    var error = false;
    $('.error').removeClass('error');
    $('#enter-details input').each(function(){
      if($(this).val() == '') {
        $(this).parent().parent().addClass('error');
        error = true;
      }
    });
    if(error) return false;
    if($('[name=password]').val() == $('[name=confirm]').val()) {
      $('#confirm').removeClass('error');
      return true;
    } else {
      $('#confirm').addClass('error');
      return false;
    }
  }
});

$(function(){
  // When scrolling over a snippet editor, activate the "clone in IDE" popovers
  $('article').each(function(){
    var n = 100;
    var wait = 10000;
    function check(){
      if($('.clone').length == 0) {
        setTimeout(check,n);
        return;
      }
      var activated = $.cookie('clone-popover');
      if (activated) return;
      var activate = false;
      $('.controlsRun:onScreen').each(function(){
        $.cookie('clone-popover', 'true', { expires: 30, path: '/' });
        activate = true;
        return false;
      });
      if(activate) {
          $('.clone').each(function(){
              // The bootstrap API is rather unreasonable to say the
              // least.
              next = $(this).parent();
              var title = next.attr('title');
              next.attr('data-content',$(this).attr('data-content'));
              next.attr('title',$(this).attr('title'));
              next.popover('show',{
                  title: $(this).attr('title')
              });
              next.attr('title',title);
          });
          setTimeout(function(){
              $('.clone').each(function(){
                  $(this).parent().popover('hide');
              });
          },wait);
      } else {
        setTimeout(check,n);
      }
    }
    setTimeout(check,n);
  });
});

// onScreen jQuery plugin v0.2.1
// (c) 2011-2013 Ben Pickles
//
// http://benpickles.github.com/onScreen
//
// Released under MIT license.
(function(a){a.expr[":"].onScreen=function(b){var c=a(window),d=c.scrollTop(),e=c.height(),f=d+e,g=a(b),h=g.offset().top,i=g.height(),j=h+i;return h>=d&&h<f||j>d&&j<=f||i>e&&h<=d&&j>=f}})(jQuery);

/*!
 * jQuery Cookie Plugin v1.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
(function($, document) {

  var pluses = /\+/g;
  function raw(s) {
    return s;
  }
  function decoded(s) {
    return decodeURIComponent(s.replace(pluses, ' '));
  }

  $.cookie = function(key, value, options) {

    // key and at least value given, set cookie...
    if (arguments.length > 1 && (!/Object/.test(Object.prototype.toString.call(value)) || value == null)) {
      options = $.extend({}, $.cookie.defaults, options);

      if (value == null) {
	options.expires = -1;
      }

      if (typeof options.expires === 'number') {
	var days = options.expires, t = options.expires = new Date();
	t.setDate(t.getDate() + days);
      }

      value = String(value);

      return (document.cookie = [
	encodeURIComponent(key), '=', options.raw ? value : encodeURIComponent(value),
	options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE
	options.path    ? '; path=' + options.path : '',
	options.domain  ? '; domain=' + options.domain : '',
	options.secure  ? '; secure' : ''
      ].join(''));
    }

    // key and possibly options given, get cookie...
    options = value || $.cookie.defaults || {};
    var decode = options.raw ? raw : decoded;
    var cookies = document.cookie.split('; ');
    for (var i = 0, parts; (parts = cookies[i] && cookies[i].split('=')); i++) {
      if (decode(parts.shift()) === key) {
	return decode(parts.join('='));
      }
    }
    return null;
  };
  $.cookie.defaults = {};})(jQuery, document);
</script><!--[if lt IE 10]><script src="https://www.schoolofhaskell.com/static/design/js/ie.js?etag=ayV2DuJ0"></script><![endif]--><script>if(!window.location.href.match(/localhost/)){var track = '/tutorial/user/pbv/an-introduction-to-quickcheck-testing';
window._gaq = [['_setAccount','UA-36928035-1'],track != ''? ['_trackPageview',track] : ['_trackPageview']
,['_trackPageLoadTime']];window._gaq.push(['_setCustomVar',1,'Section','School of Haskell',3]);
window._gaq.push(['_setCustomVar',2,'User Type','Visitor',1]);
(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);

})();}</script>
<!-- Prompt IE 6 users to install Chrome Frame. Remove this if you want to support IE 6.  chromium.org/developers/how-tos/chrome-frame-getting-started --><!--[if lt IE 7 ]><script src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script><script>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script><![endif]--></body></html>